
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>iOS å¾®ä¿¡æ”¯ä»˜åŠ©æ‰‹ IDNWxPayer - è¿·é€”è€ç çš„åšå®¢</title>
  <meta name="author" content="photondragon">

  
  <meta name="description" content="demoç¤ºä¾‹ç¨‹åº https://github.com/photondragon/IDNWxPaySample ç¤ºä¾‹ç¨‹åºè¦æƒ³æ­£å¸¸è¿è¡Œï¼Œéœ€è¦ä¿®æ”¹é¡¹ç›®çš„ URL Schemes å’Œapplication:didFinishLaunchingWithOptions: ä¸­çš„å¾®ä¿¡æ”¯ä»˜çš„åˆå§‹åŒ–å‚æ•°ï¼ˆå‚è€ƒåé¢çš„ &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.iosdev.net/articles/201606/ios-wei-xin-zhi-fu-zhu-shou-idnwxpayer">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="è¿·é€”è€ç çš„åšå®¢" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <!-- <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script> -->
  <script src="/javascripts/libs/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<!-- <link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css"> -->
<!-- <link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css"> -->

<!-- MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<!-- <script type="text/javascript" src="/javascripts/libs/MathJax/MathJax.js"></script> -->
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<!-- MathJax ends -->

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?d6cb371d896b47a663b20d215cd1bfd5";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-45991396-5', 'auto');
  ga('send', 'pageview');

</script>
  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">è¿·é€”è€ç çš„åšå®¢</a></h1>
  
    <h2>åˆ†äº«iOSå¼€å‘æŠ€æœ¯å’Œç»éªŒçš„åšå®¢</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="è®¢é˜…RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="blog.iosdev.net">
    <input class="search" type="text" name="q" results="0" placeholder="æœç´¢"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">é¦–é¡µ</a></li>
  <li><a href="/archives">æ–‡ç« åˆ—è¡¨</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">iOS å¾®ä¿¡æ”¯ä»˜åŠ©æ‰‹ IDNWxPayer</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-06-16T23:04:20+08:00'><span class='date'>2016å¹´6æœˆ16æ—¥</span> <span class='time'>11:04 pm</span></time>
        
      </p>
    
  </header>


<div class="entry-content"><p>demoç¤ºä¾‹ç¨‹åº <a href="https://github.com/photondragon/IDNWxPaySample">https://github.com/photondragon/IDNWxPaySample</a>  <br />
ç¤ºä¾‹ç¨‹åºè¦æƒ³æ­£å¸¸è¿è¡Œï¼Œéœ€è¦ä¿®æ”¹é¡¹ç›®çš„ URL Schemes å’Œapplication:didFinishLaunchingWithOptions: ä¸­çš„å¾®ä¿¡æ”¯ä»˜çš„åˆå§‹åŒ–å‚æ•°ï¼ˆå‚è€ƒåé¢çš„â€œé¡¹ç›®å‡†å¤‡â€ä¸€èŠ‚ï¼‰</p>

<p>IDNWxPayer å¯¹å¾®ä¿¡æ”¯ä»˜iosç«¯çš„æ•´ä¸ªæ”¯ä»˜æµç¨‹è¿›è¡Œäº†å°è£…ï¼ŒæŠŠå¤æ‚çš„ç»†èŠ‚éƒ½å±è”½æ‰äº†ï¼Œå¯¹å¤–æä¾›äº†ç®€å•æ˜“ç”¨çš„æ¥å£ï¼ˆå…¨éƒ¨éƒ½æ˜¯+æ–¹æ³•ï¼‰ï¼Œä¸‹å›¾åˆ—å‡ºäº†æä¾›çš„æ¥å£æ–¹æ³•ï¼š  <br />
<img src="http://res.iosdev.net/images/post/2016-06-16-ios-wei-xin-zhi-fu-zhu-shou-idnwxpayer/20160616-methods.jpg" alt="æ–¹æ³•åˆ—è¡¨" />  <br />
å¿…å®šè¦è°ƒç”¨çš„â€œæ ¸å¿ƒæ–¹æ³•â€æœ‰ä¸‰ä¸ªï¼Œå®é™…å‘èµ·æ”¯ä»˜çš„æ–¹æ³•å°±ä¸€ä¸ªï¼Œå…¶å®ƒçš„æ‰€è°“â€œä¸å®‰å…¨æ“ä½œâ€çš„æ–¹æ³•åªæœ‰åœ¨æœåŠ¡ç«¯å¼€å‘æ²¡æœ‰å®Œæˆçš„æƒ…å†µä¸‹æ‰æœ‰å¿…è¦ä½¿ç”¨ã€‚  <br />
å…¨éƒ¨çš„ä»£ç éƒ½å°è£…åœ¨ä¸¤ä¸ªæºæ–‡ä»¶ä¸­ï¼ŒIDNWxPayer.h å’Œ IDNWxPayer.m ï¼Œé™¤äº†å¾®ä¿¡å®˜æ–¹æä¾›çš„SDKåº“ä»¥å¤–ï¼Œä¸ä¾èµ–ä»»ä½•ç¬¬ä¸‰æ–¹åº“ã€‚</p>

<!--more-->

<p>å¦‚æœä½ å‘ç°äº†ä»»ä½•bugï¼Œæ¬¢è¿<a href="https://github.com/photondragon/IDNWxPaySample/issues" title="æäº¤Issues">æäº¤Issues</a></p>

<h2 id="section">ä½¿ç”¨æ–¹æ³•</h2>

<p>å¼€å‘ç¯å¢ƒï¼šxcode 7.3 + OS X EI Capitan 10.11.3</p>

<h3 id="section-1">é¡¹ç›®å‡†å¤‡</h3>

<ol>
  <li>åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„xcodeé¡¹ç›®ï¼ŒåŠ å…¥æºæ–‡ä»¶ IDNWxPayer.h å’Œ IDNWxPayer.m</li>
  <li>ä¸‹è½½ <a href="https://res.wx.qq.com/open/zh_CN/htmledition/res/dev/download/sdk/WeChatSDK1.7.1.zip" title="å¾®ä¿¡æ”¯ä»˜å®˜æ–¹SDK">å¾®ä¿¡æ”¯ä»˜å®˜æ–¹SDK</a> ï¼ŒæŠŠè§£å‹å‡ºæ¥çš„æ–‡ä»¶å¤¹ OpenSDK1.7.1 æ•´ä¸ªåŠ å…¥é¡¹ç›®ä¸­</li>
  <li>ä¸ºé¡¹ç›®æ·»åŠ  URL Schemes = <ä½ çš„å¾®ä¿¡æ”¯ä»˜çš„appid>  
 ![è®¾ç½®URL Schemes](http://res.iosdev.net/images/post/2016-06-16-ios-wei-xin-zhi-fu-zhu-shou-idnwxpayer/20160616-urlSchemes.jpg)</ä½ çš„å¾®ä¿¡æ”¯ä»˜çš„appid></li>
  <li>é“¾æ¥è¿™å‡ ä¸ªåº“: libc++.tdb, libsqlite3.tbd, libz.tbd, CoreTelephony.framework, SystemConfiguration.framework  <br />
 <img src="http://res.iosdev.net/images/post/2016-06-16-ios-wei-xin-zhi-fu-zhu-shou-idnwxpayer/20160616-link-libs.png" alt="é“¾æ¥åº“" /></li>
  <li>
    <p>åœ¨ AppDelegate.m ä¸­åŠ å…¥åˆå§‹åŒ–ä»£ç ï¼Œ<strong>æ³¨æ„è¦æŠŠåˆå§‹åŒ–å‚æ•°æ¢æˆä½ è‡ªå·±çš„</strong></p>

    <p>``` objective-c<br />
 #import â€œIDNWxPayer.hâ€</p>

    <p>// ã€‚ã€‚ã€‚å…¶å®ƒä»£ç ã€‚ã€‚ã€‚</p>

    <ul>
      <li>
        <p>(BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {</p>

        <p>[IDNWxPayer initWithAppId:@â€wx1234567812345678â€ merchantId:@â€1234567890â€]; //<br />
  [IDNWxPayer setMerchantKey:@â€12345678901234567890123456789012â€]; //è®¾ç½®å•†æˆ·å¯†é’¥ï¼Œä»…ä¾›æµ‹è¯•ä½¿ç”¨<br />
  [IDNWxPayer setNotifyUrl:@â€http://www.example.com/wxnotify.phpâ€]; //ä»…ä¾›æµ‹è¯•ä½¿ç”¨</p>

        <p>return YES;<br />
 }</p>
      </li>
    </ul>

    <p>// ios &lt; 9.0<br />
 - (BOOL)application:(UIApplication *)application openURL:(NSURL *)url sourceApplication:(NSString *)sourceApplication annotation:(id)annotation<br />
 {<br />
     if([IDNWxPayer handleOpenURL:url]) //å¤„ç†ä»å¾®ä¿¡å®¢æˆ·ç«¯è·³è½¬å›æ¥çš„urlã€‚è¿”å› TRUE è¡¨ç¤ºæˆåŠŸå¤„ç†äº†<br />
         return YES;<br />
     return NO;<br />
 }</p>

    <p>// ios &gt;= 9.0<br />
 - (BOOL)application:(UIApplication *)application openURL:(NSURL *)url options:(NSDictionary&lt;NSString *,id&gt; *)options<br />
 {<br />
     if([IDNWxPayer handleOpenURL:url]) //å¤„ç†ä»å¾®ä¿¡å®¢æˆ·ç«¯è·³è½¬å›æ¥çš„urlã€‚è¿”å› TRUE è¡¨ç¤ºæˆåŠŸå¤„ç†äº†<br />
         return YES;<br />
     return NO;<br />
 }</p>

    <p>```</p>
  </li>
</ol>

<p>ç°åœ¨ä½ å¯ä»¥å¼€å§‹ç¼–å†™æ”¯ä»˜ä»£ç äº†ï¼Œä¸è¿‡åœ¨è¿™ä¹‹å‰ï¼Œæœ€å¥½å…ˆäº†è§£ä¸€ä¸‹å¾®ä¿¡æ”¯ä»˜æµç¨‹</p>

<h3 id="section-2">å¾®ä¿¡æ”¯ä»˜æµç¨‹ï¼š</h3>
<ol>
  <li>å‘å¾®ä¿¡ä¸‹å•ï¼Œå¾—åˆ°prepayIdï¼ˆå»ºè®®åœ¨æœåŠ¡ç«¯å®ç°ï¼‰</li>
  <li>æ ¹æ®prepayIdç”Ÿæˆ<strong>åŒ…å«ç­¾å</strong>çš„â€œæ”¯ä»˜è¯·æ±‚å‚æ•°â€ï¼ˆå»ºè®®åœ¨æœåŠ¡ç«¯å®ç°ï¼‰</li>
  <li>ä½ çš„å®¢æˆ·ç«¯å‘èµ·æ”¯ä»˜ï¼ˆéœ€è¦ç¬¬2æ­¥ç”Ÿæˆçš„æ”¯ä»˜è¯·æ±‚å‚æ•°ï¼‰</li>
  <li>è‡ªåŠ¨è·³è½¬åˆ°å¾®ä¿¡å®¢æˆ·ç«¯ï¼Œç”¨æˆ·ä»˜æ¬¾ï¼ŒæˆåŠŸæˆ–å–æ¶ˆåä¼šè‡ªåŠ¨è·³è½¬å›ä½ çš„å®¢æˆ·ç«¯ï¼ˆå¦‚æœä»˜æ¬¾æˆåŠŸï¼Œå¾®ä¿¡æœåŠ¡å™¨ä¼šé€šçŸ¥ä½ çš„æœåŠ¡å™¨ï¼‰</li>
  <li>ä½ çš„å®¢æˆ·ç«¯ï¼ˆå‘ä½ çš„æœåŠ¡å™¨ï¼‰éªŒè¯æ”¯ä»˜ç»“æœ</li>
</ol>

<h3 id="section-3">ç¼–å†™æ”¯ä»˜ä»£ç </h3>

<h4 id="section-4">æ­£å¸¸æƒ…å†µğŸ˜„</h4>

<p>å¦‚æœä½ ä»¬çš„æœåŠ¡ç«¯å°ä¼™ä¼´æŠŠå¾®ä¿¡æ”¯ä»˜æµç¨‹çš„ç¬¬1ï¼Œ2æ­¥éƒ½æå®šäº†ï¼ŒæŠŠæ”¯ä»˜è¯·æ±‚å‚æ•°ä¼ ç»™äº†å®¢æˆ·ç«¯ğŸ˜„ï¼Œé‚£ä¹ˆä½ åªéœ€è¦è°ƒç”¨ +payWithParams:result: æ–¹æ³•å°±å¯ä»¥å‘èµ·å¾®ä¿¡æ”¯ä»˜äº†ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
</pre></td><td class="code"><pre><code class="objective-c"><span class="line"><span class="p">[</span><span class="n">IDNWxPayer</span> <span class="nl">payWithParams</span><span class="p">:</span><span class="n">payParams</span> <span class="nl">result</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="bp">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">	<span class="k">if</span><span class="p">(</span><span class="n">error</span><span class="p">){</span>
</span><span class="line">		<span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;æ”¯ä»˜å¤±è´¥ï¼š%@&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">.</span><span class="n">localizedDescription</span><span class="p">);</span>
</span><span class="line">	<span class="p">}</span>
</span><span class="line">	<span class="k">else</span><span class="p">{</span>
</span><span class="line">		<span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;æ”¯ä»˜æˆåŠŸï¼ˆåªæ˜¯â€œæ”¯ä»˜â€æˆåŠŸï¼‰&quot;</span><span class="p">);</span>
</span><span class="line">		<span class="c1">// todo è¿™é‡Œè¿˜è¦å‘ä½ çš„æœåŠ¡å™¨éªŒè¯æ”¯ä»˜ç»“æœï¼ˆæ£€æµ‹è®¢å•æ˜¯å¦å®Œæˆï¼‰</span>
</span><span class="line">	<span class="p">}</span>
</span><span class="line"><span class="p">}];</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
<p><strong>æ³¨æ„</strong>ï¼šresultè¿™ä¸ªblockæ˜¯ç”¨æ¥æ¥æ”¶æ”¯ä»˜ç»“æœçš„ï¼Œerror==nilè¡¨ç¤ºæ”¯ä»˜æˆåŠŸï¼Œå¦åˆ™è¡¨ç¤ºæ”¯ä»˜å¤±è´¥ã€‚ä½†æ˜¯resultè¿™ä¸ªblock<strong>ä¸ä¸€å®šä¼šè¢«è°ƒç”¨</strong>ï¼Œå› ä¸ºä½ å¯ä»¥åœ¨è·³è½¬åˆ°å¾®ä¿¡å®¢æˆ·ç«¯åç›´æ¥å…³é—­å¾®ä¿¡ï¼Œç„¶åæ‰‹åŠ¨ç‚¹å¼€è‡ªå·±çš„åº”ç”¨ï¼Œè€Œä¸æ˜¯è®©å¾®ä¿¡è‡ªåŠ¨è·³å›ã€‚è¿™ç§æƒ…å†µæ€ä¹ˆå¤„ç†å¯ä»¥åˆ° IDNWxPayer.h é‡Œå»çœ‹å‡½æ•°æ–‡æ¡£ã€‚</p>

<h4 id="section-5">æƒ…å†µ2ğŸ™</h4>

<p>å¦‚æœä½ ä»¬çš„æœåŠ¡ç«¯å°ä¼™ä¼´æå®šäº†å¾®ä¿¡æ”¯ä»˜æµç¨‹çš„ç¬¬1æ­¥ï¼Œç„¶åç»™äº†ä½ ä¸€ä¸ªprepayidğŸ™ï¼Œé‚£ä¹ˆä½ å¯ä»¥è°ƒç”¨ +payWithPrepayId:result: æ–¹æ³•å‘èµ·å¾®ä¿¡æ”¯ä»˜ï¼Œä½†å¿…é¡»åœ¨åˆå§‹åŒ–çš„æ—¶å€™è°ƒç”¨ +setMerchantKey: è®¾ç½®å•†æˆ·å¯†é’¥ï¼ˆç”¨äºç­¾åï¼‰ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
</pre></td><td class="code"><pre><code class="objective-c"><span class="line"><span class="p">[</span><span class="n">IDNWxPayer</span> <span class="nl">payWithPrepayId</span><span class="p">:</span><span class="n">prepayId</span> <span class="nl">result</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="bp">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">	<span class="k">if</span><span class="p">(</span><span class="n">error</span><span class="p">){</span>
</span><span class="line">		<span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;æ”¯ä»˜å¤±è´¥ï¼š%@&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">.</span><span class="n">localizedDescription</span><span class="p">);</span>
</span><span class="line">	<span class="p">}</span>
</span><span class="line">	<span class="k">else</span><span class="p">{</span>
</span><span class="line">		<span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;æ”¯ä»˜æˆåŠŸï¼ˆåªæ˜¯â€œæ”¯ä»˜â€æˆåŠŸï¼‰&quot;</span><span class="p">);</span>
</span><span class="line">		<span class="c1">// todo è¿™é‡Œè¿˜è¦å‘ä½ çš„æœåŠ¡å™¨éªŒè¯æ”¯ä»˜ç»“æœï¼ˆæ£€æµ‹è®¢å•æ˜¯å¦å®Œæˆï¼‰</span>
</span><span class="line">	<span class="p">}</span>
</span><span class="line"><span class="p">}];</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h4 id="section-6">æƒ…å†µ3ğŸ˜ </h4>

<p>å¦‚æœä½ ä»¬çš„æœåŠ¡ç«¯å°ä¼™ä¼´è¿å¾®ä¿¡æ”¯ä»˜æµç¨‹çš„ç¬¬1æ­¥éƒ½è¿˜æ²¡æå®šğŸ˜ ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿå½“ç„¶æœ‰åŠæ³•ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±å‘å¾®ä¿¡æœåŠ¡å™¨ä¸‹å•ï¼ˆå‰ææ˜¯åœ¨åˆå§‹åŒ–çš„æ—¶å€™è®¾ç½®äº†merchantKeyå’ŒnotifyUrlï¼‰ã€‚  <br />
å…ˆè°ƒç”¨ +prepayWithOrderId:amount:orderTitle:orderDetail:callback: æ–¹æ³•ä¸‹å•ï¼ˆå‚æ•°ä½ å°±éšä¾¿å¡«å§ï¼Œåæ­£åªæ˜¯æµ‹è¯•ï¼‰ï¼Œä¸‹å•æˆåŠŸåé€šè¿‡ callback å¾—åˆ°æ”¯ä»˜è¯·æ±‚å‚æ•°ï¼Œå†è°ƒç”¨ +payWithParams:result: å‘èµ·æ”¯ä»˜ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
</pre></td><td class="code"><pre><code class="objective-c"><span class="line"><span class="p">[</span><span class="n">IDNWxPayer</span> <span class="nl">prepayWithOrderId</span><span class="p">:</span><span class="n">orderId</span> <span class="nl">amount</span><span class="p">:</span><span class="n">amount</span> <span class="nl">orderTitle</span><span class="p">:</span><span class="n">orderTitle</span> <span class="nl">orderDetail</span><span class="p">:</span><span class="nb">nil</span> <span class="nl">callback</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="bp">NSDictionary</span> <span class="o">*</span><span class="n">payParams</span><span class="p">,</span> <span class="bp">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">	<span class="k">if</span><span class="p">(</span><span class="n">error</span><span class="p">){</span>
</span><span class="line">		<span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;ä¸‹å•å¤±è´¥ï¼š%@&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">.</span><span class="n">localizedDescription</span><span class="p">);</span>
</span><span class="line">	<span class="p">}</span>
</span><span class="line">	<span class="k">else</span><span class="p">{</span>
</span><span class="line">		<span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;ä¸‹å•æˆåŠŸï¼š%@&quot;</span><span class="p">,</span> <span class="n">payParams</span><span class="p">);</span>
</span><span class="line">		<span class="c1">// å‘èµ·å¾®ä¿¡æ”¯ä»˜</span>
</span><span class="line">		<span class="p">[</span><span class="n">IDNWxPayer</span> <span class="nl">payWithParams</span><span class="p">:</span><span class="n">payParams</span> <span class="nl">result</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="bp">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">			<span class="c1">// ...æ­¤å¤„çœç•¥å¤„ç†æ”¯ä»˜ç»“æœçš„ä»£ç ...</span>
</span><span class="line">		<span class="p">}];</span>
</span><span class="line">	<span class="p">}</span>
</span><span class="line"><span class="p">}];</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="section-7">å‚è€ƒ</h2>
<ol>
  <li><a href="https://pay.weixin.qq.com/wiki/doc/api/app/app.php?chapter=8_5" title="å¾®ä¿¡æ”¯ä»˜å®˜æ–¹IOSæ–‡æ¡£">å¾®ä¿¡æ”¯ä»˜å®˜æ–¹IOSæ–‡æ¡£</a></li>
  <li><a href="https://pay.weixin.qq.com/wiki/doc/api/app/app.php?chapter=11_1" title="å¾®ä¿¡æ”¯ä»˜å…¨éƒ¨ SDK ä¸‹è½½é¡µé¢">å¾®ä¿¡æ”¯ä»˜å…¨éƒ¨ SDK ä¸‹è½½é¡µé¢</a></li>
</ol>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard"><span class="fn">photondragon</span></span>

      




<time class='entry-date' datetime='2016-06-16T23:04:20+08:00'><span class='date'>2016å¹´6æœˆ16æ—¥</span> <span class='time'>11:04 pm</span></time>
      

<span class="categories">
  
    <a class='category' href='/categories/yuan-ma-gong-xiang/'>æºç å…±äº«</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/articles/201507/xcodedai-ma-pian-duan" title="Previous Post: Xcodeä»£ç ç‰‡æ®µSnippets">&laquo; Xcodeä»£ç ç‰‡æ®µSnippets</a>
      
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>æœ€æ–°æ–‡ç« </h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/articles/201606/ios-wei-xin-zhi-fu-zhu-shou-idnwxpayer">iOS å¾®ä¿¡æ”¯ä»˜åŠ©æ‰‹ IDNWxPayer</a>
      </li>
    
      <li class="post">
        <a href="/articles/201507/xcodedai-ma-pian-duan">Xcodeä»£ç ç‰‡æ®µSnippets</a>
      </li>
    
      <li class="post">
        <a href="/articles/201506/ce-shi">æµ‹è¯•</a>
      </li>
    
      <li class="post">
        <a href="/articles/201506/huan-ying">æ¬¢è¿æ¥åˆ°è¿·é€”è€ç çš„åšå®¢</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>åˆ†ç±»ç›®å½•</h1>
  <ul id="categories">
    <li class='category'><a href='/categories/shi-yong-ji-qiao/'>å®ç”¨æŠ€å·§ (1)</a></li>
<li class='category'><a href='/categories/za-xiang/'>æ‚é¡¹ (2)</a></li>
<li class='category'><a href='/categories/yuan-ma-gong-xiang/'>æºç å…±äº« (1)</a></li>

  </ul>
</section>




  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - photondragon -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  











</body>
</html>
